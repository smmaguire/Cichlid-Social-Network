plot.igraph(networkList[["Et3"]],mark.groups=groups,layout=coords,main="Day 3",edge.width=get.edge.attribute(networkList[["Et3"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",vertex.frame.color=NA)
plot.igraph(networkList[["Et4"]],mark.groups=groups,layout=coords,main="Day 4",edge.width=get.edge.attribute(networkList[["Et4"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",vertex.frame.color=NA)
dev.off()
networkList[["Et1"]]
?tkplot
plot.igraph(networkList[["Et1"]],mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.arrow.color='black')
vertex.frame.color=NA,arrow.color='black')
plot.igraph(networkList[["Et1"]],mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,arrow.color='black')
plot.igraph(networkList[["Et1"]],mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et1"]]),mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
pdf("networkplots.pdf")
plot.igraph(as.undirected(networkList[["Et1"]]),mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et2"]]),mark.groups=groups,layout=coords,main="Day 2",edge.width=get.edge.attribute(networkList[["Et2"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",vertex.frame.color=NA)
plot.igraph(as.undirected(networkList[["Et3"]]),mark.groups=groups,layout=coords,main="Day 3",edge.width=get.edge.attribute(networkList[["Et3"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et4"]]),mark.groups=groups,layout=coords,main="Day 4",edge.width=get.edge.attribute(networkList[["Et4"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
dev.off()
plot.igraph(networkList[["Et1"]],mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
pdf("networkplots.pdf")
plot.igraph(networkList[["Et1"]],mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et2"]],mark.groups=groups,layout=coords,main="Day 2",edge.width=get.edge.attribute(networkList[["Et2"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et3"]],mark.groups=groups,layout=coords,main="Day 3",edge.width=get.edge.attribute(networkList[["Et3"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et4"]],mark.groups=groups,layout=coords,main="Day 4",edge.width=get.edge.attribute(networkList[["Et4"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
dev.off()
pdf("networkplots.pdf")
plot.igraph(as.undirected(networkList[["Et1"]]),mark.groups=groups,layout=coords,main="Day 1",edge.width=get.edge.attribute(networkList[["Et1"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et2"]]),mark.groups=groups,layout=coords,main="Day 2",edge.width=get.edge.attribute(networkList[["Et2"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et3"]]),mark.groups=groups,layout=coords,main="Day 3",edge.width=get.edge.attribute(networkList[["Et3"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(as.undirected(networkList[["Et4"]]),mark.groups=groups,layout=coords,main="Day 4",edge.width=get.edge.attribute(networkList[["Et4"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
dev.off()
plot.igraph(networkList[["Et2"]],mark.groups=groups,layout=coords,main="Day 2",edge.width=get.edge.attribute(networkList[["Et2"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et3"]],mark.groups=groups,layout=coords,main="Day 3",edge.width=get.edge.attribute(networkList[["Et3"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et4"]],mark.groups=groups,layout=coords,main="Day 4",edge.width=get.edge.attribute(networkList[["Et4"]],"weight")/2,
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
plot.igraph(networkList[["Et4"]],mark.groups=groups,layout=coords,main="Day 4",
edge.arrow.size=.5,edge.arrow.width=.7,mark.col=group.colors,mark.border=group.border,vertex.color=colors,vertex.label="",
vertex.frame.color=NA,edge.color='black')
rm(list=ls())
setwd("/Volumes/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level")
rm(list=ls())
setwd("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level")
source('//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/community level/refactored_functions_simulation.R')
source('//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/raw data/iGraph data pullout_updated.R')
attributes<-getWTcom(networkList,matrixList)
template<-read.csv("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level/template.csv")
for(gname in names(networkList)){
m<-matrixList[[gname]]
g<-networkList[[gname]]
attr<-attributes[[gname]]
degM<-degree_from_sex(m,"M",attr)
degF<-degree_from_sex(m,"F",attr)
cc<-transitivity(g,type="weighted")
ccdf<-data.frame(unique=V(g)$name,cc=cc)
pr<-data.frame(unique=names(page.rank(g)$vector),pageRank=page.rank(g)$vector)
attr$day<-as.numeric(strsplit(gname,"t")[[1]][2])
attr<-dplyr::left_join(attr,degM,by="unique")
attr<-dplyr::left_join(attr,degF,by="unique")
attr<-dplyr::left_join(attr,ccdf,by="unique")
attr<-dplyr::left_join(attr,pr,by="unique")
template<-rbind(template,attr)
}
ind.data<-template[-1,]
#manipulated group is A2, B3 and C5, D1, E5, F2.
ind.data<-ind.data[-which(ind.data$sex=="A"),]
ind.data<-mutate(ind.data,manip= ifelse(unique=="A2M1"|unique=="B3M1"|unique=="C5M1"|unique=="D1M1"|unique=="E5M1","manipulated","non-manipulated"))
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+facet_grid(~sex)
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+facet_grid(~sex)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+facet_grid(~sex)
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,col=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+facet_grid(~sex)
day.1.data<-filter(ind.data,day==1)
day.1.data$sub_group<-as.character(day.1.data$community)
in.group<-vector()
for(i in 1:nrow(day.1.data)){
if(day.1.data$sub_group[i]=="A"&day.1.data$wtcom[i]==day.1.data$wtcom[day.1.data$unique=="A2M1"]) in.group<-c(in.group,"in.group") else
if(day.1.data$sub_group[i]=="A"&day.1.data$wtcom[i]!=day.1.data$wtcom[day.1.data$unique=="A2M1"]) in.group<-c(in.group,"out.group") else
if(day.1.data$sub_group[i]=="B"&day.1.data$wtcom[i]==day.1.data$wtcom[day.1.data$unique=="B3M1"]) in.group<-c(in.group,"in.group") else
if(day.1.data$sub_group[i]=="B"&day.1.data$wtcom[i]!=day.1.data$wtcom[day.1.data$unique=="B3M1"]) in.group<-c(in.group,"out.group") else
if(day.1.data$sub_group[i]=="C"&day.1.data$wtcom[i]==day.1.data$wtcom[day.1.data$unique=="C5M1"]) in.group<-c(in.group,"in.group") else
if(day.1.data$sub_group[i]=="C"&day.1.data$wtcom[i]!=day.1.data$wtcom[day.1.data$unique=="C5M1"]) in.group<-c(in.group,"out.group") else
if(day.1.data$sub_group[i]=="D"&day.1.data$wtcom[i]==day.1.data$wtcom[day.1.data$unique=="D1M1"]) in.group<-c(in.group,"in.group") else
if(day.1.data$sub_group[i]=="D"&day.1.data$wtcom[i]!=day.1.data$wtcom[day.1.data$unique=="D1M1"]) in.group<-c(in.group,"out.group") else
if(day.1.data$sub_group[i]=="E"&day.1.data$wtcom[i]==day.1.data$wtcom[day.1.data$unique=="E5M1"]) in.group<-c(in.group,"in.group") else
if(day.1.data$sub_group[i]=="E"&day.1.data$wtcom[i]!=day.1.data$wtcom[day.1.data$unique=="E5M1"]) in.group<-c(in.group,"out.group")
}
tojoin<-data.frame(unique=day.1.data$unique,in.group)
ind.data2<-left_join(ind.data,tojoin,by="unique")
ggplot(ind.data2,aes(x=factor(day),y=indegree_from_M,col=manip))+geom_boxplot()+facet_wrap(sex~in.group)+ylab('indegree from males')
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+facet_grid(~sex)
ggplot(filter(ind.data,sex=="M"),aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")
ind.data<-filter(ind.data,sex=="M",day<=4)
ggplot(ind.data,sex=="M",aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,col=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+scale_color_grey()
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+scale_fill_grey()
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+scale_fill_grey(start=.2)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+scale_fill_grey(start=5)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+scale_fill_grey(start=.5)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,col=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,col=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
getwd()
setwd("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level")
pdf('ind_data.pdf')
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
dev.off()
qqnorm(ind.data$indegree_from_M)
qqnorm(log10(ind.data$indegree_from_M))
qqnorm(ind.data$indegree_from_M)
qqnorm(ind.data$outdegree_from_M)
?lmer
library(lme4)
?lmer
model1<-lmer(outdegree_from_F~factor(day)+(1|unique),family=poisson)
model1<-glmer(outdegree_from_F~factor(day)*manipulated+(1|unique),family=poisson,data=ind.data)
model1<-glmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
model1<-glmer(outdegree_from_F~factor(day)*manip+(1|unique),data=ind.data)
model1<-lmer(outdegree_from_F~factor(day)*manip+(1|unique),data=ind.data)
summary(model1)
model1<-lmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
?glmer
summary(model1)
out2F<-glmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
inFromF<-glmer(indegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
summary(inFromF)
out2F<-car::Anova(glmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data),type=3)
out2F
inFromF<-car::Anova(glmer(indegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data),type=3)
summary(inFromF)
inFromF
out2M<-car::Anova(glmer(outdegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data),type=3)
out2M
outdegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
glmer(outdegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
out2F<-glmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
inFromF<-glmer(indegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
out2M<-glmer(outdegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
inFromM<-glmer(indegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
summary(inFromM)
summary(out2M)
car::Anova(out2F,type=3)
car::Anova(inFromF,type=3)
car::Anova(out2M,type=3)
car::Anova(inFromM,type=3)
summary(inFromF)
summary(out2M)
car::Anova(out2M,type=3)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
require(lsmeans)
install.packages('lsmeans')
require(lsmeans)
require(multcomp)
require(multcompView)
install.packages('multcompView')
require(multcompView)
lsmean.matrix<-lsmeans(out2M,"manip",by="time")
ind.data$day<-as.factor(ind.data$day)
out2F<-glmer(outdegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
car::Anova(out2F,type=3)
inFromF<-glmer(indegree_from_F~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromF,type=3)
summary(inFromF)
out2M<-glmer(outdegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"manip",by="time")
lsmean.matrix<-lsmeans(out2M,"manip",by="day")
ind.data$day
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
car::Anova(out2F,type=3)
inFromF<-glmer(indegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromF,type=3)
summary(inFromF)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"manip",by="day")
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"manip",by="day")
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
summary(out2M)
out2M
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
ind.data$manip
ind.data$manip<-as.factor(ind.data$manip)
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
car::Anova(out2F,type=3)
inFromF<-glmer(indegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromF,type=3)
summary(inFromF)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
lsmeans.matrix
lsmean.matrix
pairs(lsmean.matrix)
cld(lsmean.matrix)
lsmean.matrix<-lsmeans(inFromF,"day",by="manip")
pairs(lsmean.matrix)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
lsmean.matrix<-lsmeans(inFromM,"day",by="manip")
inFromM<-glmer(indegree_from_M~factor(day)*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromM,type=3)
lsmean.matrix<-lsmeans(inFromM,"day",by="manip")
inFromM<-glmer(indegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(inFromM,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(out2F,type=3)
lsmean.matrix<-lsmeans(out2F,"day",by="manip")
pairs(lsmean.matrix)
contrast(days.lsm, "trt.vs.ctrl", ref = c(1,2,3))
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
car::Anova(out2F,type=3)
lsmean.matrix<-lsmeans(out2F,"day",by="manip")
pairs(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
inFromF<-glmer(indegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromF,type=3)
summary(inFromF)
lsmean.matrix<-lsmeans(inFromF,"day",by="manip")
pairs(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
inFromM<-glmer(indegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
car::Anova(inFromM,type=3)
lsmean.matrix<-lsmeans(inFromM,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
inFromM<-glmer(indegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(inFromM)
inFromF<-glmer(indegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(inFromF)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
summary(out2F)
lsmean.matrix<-lsmeans(inFromF,"day",by="manip")
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
pdf('ind_data.pdf')
ind.data<-filter(ind.data,sex=="M",day<=4)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
dev.off()
dev.off()
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
rm(list=ls())
setwd("/Volumes/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level")
source('//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/community level/refactored_functions_simulation.R')
source('//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/raw data/iGraph data pullout_updated.R')
setwd("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level")
attributes<-getWTcom(networkList,matrixList)
template<-read.csv("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/individual level/template.csv")
for(gname in names(networkList)){
m<-matrixList[[gname]]
g<-networkList[[gname]]
attr<-attributes[[gname]]
degM<-degree_from_sex(m,"M",attr)
degF<-degree_from_sex(m,"F",attr)
cc<-transitivity(g,type="weighted")
ccdf<-data.frame(unique=V(g)$name,cc=cc)
pr<-data.frame(unique=names(page.rank(g)$vector),pageRank=page.rank(g)$vector)
attr$day<-as.numeric(strsplit(gname,"t")[[1]][2])
attr<-dplyr::left_join(attr,degM,by="unique")
attr<-dplyr::left_join(attr,degF,by="unique")
attr<-dplyr::left_join(attr,ccdf,by="unique")
attr<-dplyr::left_join(attr,pr,by="unique")
template<-rbind(template,attr)
}
ind.data<-template[-1,]
ind.data<-ind.data[-which(ind.data$sex=="A"),]
ind.data<-mutate(ind.data,manip= ifelse(unique=="A2M1"|unique=="B3M1"|unique=="C5M1"|unique=="D1M1"|unique=="E5M1","manipulated","non-manipulated"))
ind.data<-filter(ind.data,sex=="M",day<=4)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
pdf('ind_data.pdf')
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
dev.off()
pdf('ind_data.pdf',useDingbats = F)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")
dev.off()
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
pdf('ind_data.pdf',useDingbats = F)
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_F,fill=manip))+geom_boxplot()+theme_bw()+ylab("Indegree from female")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=outdegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("Outdegree towards males")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
ggplot(ind.data,aes(x=factor(day),y=indegree_from_M,fill=manip))+geom_boxplot()+theme_bw()+ylab("indegree from male")+
scale_fill_grey(start=.5)+xlab("Day")+ylim(c(0,35))
dev.off()
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
summary(out2M)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
out2F<-glmer(outdegree_from_F~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2F)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
inFromM<-glmer(indegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(inFromM)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
ind.data$day<-as.factor(ind.data$day)
ind.data$manip<-as.factor(ind.data$manip)
summary(out2M)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
setwd("//files.ccbb.utexas.edu/hofmannlab/Shared/All projects/N. multifasciatus Social Networks/community level")
load("permutation_data_with_walktrap.RDATA")
perms<-list(groupA.walktrap,groupB.walktrap,groupC.walktrap,groupD.walktrap,groupE.walktrap)
plotDataGroup<-data.frame("firstQ"=vector(),"thirdQ"=vector(),"correlation"=vector(),
"group"=vector(),"pval"=vector())
count<-1
dist<-vector()
group.dist<-vector()
comp.dist<-vector()
for (perm in perms) {
firstQ<-vector()
thirdQ<-vector()
testVal<-vector()
name.count<-1
for(comp in perm[[1]]){
firstQ<-c(firstQ,summary(comp$dist)[2])
thirdQ<-c(thirdQ,summary(comp$dist)[5])
testVal<-c(testVal,comp$testval)
dist<-c(dist,comp$dist)
group.dist<-c(group.dist,rep(LETTERS[count],length(comp$dist)))
comp.dist<-c(comp.dist,rep(names(perm[[1]])[name.count],length(comp$dist)))
name.count<-name.count+1
}
plotDataTemp<-(cbind(firstQ,thirdQ,correlation=testVal,group=LETTERS[count],pval=perm[[2]],deparse.level=1))
rownames(plotDataTemp)<-NULL
plotDataTemp<-as.data.frame(plotDataTemp)
plotDataGroup<-rbind(plotDataGroup,plotDataTemp)
count<-count+1
}
plotDataGroup$firstQ<-as.numeric(as.character(plotDataGroup$firstQ))
plotDataGroup$thirdQ<-as.numeric(as.character(plotDataGroup$thirdQ))
plotDataGroup$correlation<-as.numeric(as.character(plotDataGroup$correlation))
plotDataGroup$timeComp<-as.factor(rep(c('1 2','2 3','3 4','4 5','5 6','6 7'),length(perms)))
dist.data<-data.frame(dist,timeComp=comp.dist,group=group.dist)
violin<-ggplot(dist.data,aes(x=timeComp,y=dist,col=group))
walktrap.first4days<-filter(plotDataGroup,timeComp %in% c("1 2","2 3","3 4"))
mmWt<-lme4::lmer(correlation~timeComp+(1|group),data=walktrap.first4days)
car::Anova(mmWt,type=3)
library(multcomp)
contr <- rbind("pre - post" = c(1, 1, -1),
"pre - pre" = c(1,-1,0))
summary(glht(mmWt, linfct = mcp(timeComp = contr)))
walktrap.first4days
plotDataGroup$adj.pvals<-p.adjust(as.numeric(as.character(plotDataGroup$pval)),method="hochberg")
walktrap.first4days
walktrap.first4days<-filter(plotDataGroup,timeComp %in% c("1 2","2 3","3 4"))
walktrap.first4days
ind.data
out2F<-glmer(outdegree_from_F~day*manip+(1|unique)+(1|community),family=poisson,data=ind.data)
summary(out2F)
car::Anova(out2F,type=3)
lsmean.matrix<-lsmeans(out2F,"day",by="manip")
pairs(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
car::Anova(inFromF,type=3)
summary(inFromF)
inFromF<-glmer(indegree_from_F~day*manip+(1|unique)+(1|community),family=poisson,data=ind.data)
car::Anova(inFromF,type=3)
summary(inFromF)
lsmean.matrix<-lsmeans(inFromF,"day",by="manip")
pairs(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
out2M<-glmer(outdegree_from_M~day*manip+(1|unique),family=poisson,data=ind.data)
summary(out2M)
out2M<-glmer(outdegree_from_M~day*manip+(1|unique)+(1|community),family=poisson,data=ind.data)
summary(out2M)
lsmean.matrix<-lsmeans(out2M,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
inFromM<-glmer(indegree_from_M~day*manip+(1|unique)+(1|community),family=poisson,data=ind.data)
summary(inFromM)
car::Anova(inFromM,type=3)
lsmean.matrix<-lsmeans(inFromM,"day",by="manip")
pairs(lsmean.matrix)
cld(lsmean.matrix)
contrast(lsmean.matrix, "trt.vs.ctrl", ref = c(1,2,3))
